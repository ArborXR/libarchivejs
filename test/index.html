<!DOCTYPE html>
<html>
    <head>
        <title>test webworker</title>
    </head>
    <body>
        <input type="file" id="file" />
        <script type="module" >

            import {Archive} from '../src/libarchive.js';

            Archive.init({
                workerUrl: '../dist/worker-bundle.js'
            });

            document.getElementById('file').addEventListener('change', async (e) => {
                const file = e.currentTarget.files[0];

                const archive = await Archive.open(file);
                
                performance.mark('list_start');
                let obj = await archive.extractFiles();

                let list = await archive.extractFiles();
                list['addon']['addon.py'] = null;
                performance.mark('list_end');
                console.log(list);       
                console.log(obj);       
                performance.measure('skip_decompression','list_start','list_end');


                var measures = performance.getEntriesByName("skip_decompression");
                var measure = measures[0];
                console.log("setTimeout milliseconds:", measure.duration)
                
                /*performance.mark('archive_start');
                obj = await archive.extractFiles();
                performance.mark('archive_end');
                console.log(obj);*/
            });

            //worker.addEventListener('message',(e) => {
                //console.log(e.data);
                /*const link = document.createElement( 'a' );
                link.style.display = 'block';
                link.textContent = e.data.name;
                document.body.appendChild( link );
                const objectURL = URL.createObjectURL( e.data );
                link.href = objectURL;
                link.download =  e.data.name;*/
            //});
        </script>
    </body>
</html>